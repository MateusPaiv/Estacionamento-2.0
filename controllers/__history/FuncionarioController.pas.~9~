unit FuncionarioController;

interface

uses
  SqlDtg;
type
  TFuncionarioController = class
    private
    public
      function insertFuncionario(nome,sobrenome,cpf,celular,cep,endereco,numero:string):boolean;
      procedure carregarGrid(Grid:TSqlDtGrid);
  end;
implementation

uses
  Vcl.Dialogs,Generics.Collections,FuncionarioModel,connection,
  RpDriverAdapter, SqlFun;

{ TFuncionarioController }

procedure TFuncionarioController.carregarGrid(Grid: TSqlDtGrid);
var Q:IQuery;
    i:integer;
begin
   i:=1;
   Q:= SqlToQuery('select * from funcionarios');
   if not Q.IsEmpty then begin
     while not Q.Eof do begin
       Grid.Cells[Grid.GetColumn('nome'),i]:=Q.getString('nome');
       Grid.Cells[Grid.GetColumn('sobrenome'),i]:=Q.getString('sobrenome');
       Grid.Cells[Grid.GetColumn('modelo'),i]:=Q.getString('modelo');
       Grid.Cells[Grid.GetColumn('ano'),i]:=Q.getString('ano');
       Grid.Cells[Grid.GetColumn('placa'),i]:=Q.getString('placa');
       inc(i);
       if Grid.RowCount < i then begin
          Grid.CreateNewRow;
       end;
       Q.Next;
     end;
     Q.Free;Q.Close;
   end else begin
     Aviso('nenhum usuário encontrado');
   end;
end;

function TFuncionarioController.insertFuncionario(nome, sobrenome, cpf, celular,cep, endereco, numero: string): boolean;
var listaFuncionario:TObjectList<TFuncionario> ;
begin
   if (nome='') then begin
      MessageDlg('Nome não pode estar vazio',mtinformation,[mbOK],0);
      Result := false;
      exit;
   end;
   if (sobrenome='') then begin
      MessageDlg('Sobrenome não pode estar vazio',mtinformation,[mbOK],0);
      Result := false;
      exit;
   end;
   if (Cpf='') then begin
      MessageDlg('CPF não pode estar vazio',mtinformation,[mbOK],0);
      Result := false;
      exit;
   end;
    if (celular='') then begin
      MessageDlg('Nome não pode estar vazio',mtinformation,[mbOK],0);
      Result := false;
      exit;
   end;
    if (cep='') then begin
      MessageDlg('Nome não pode estar vazio',mtinformation,[mbOK],0);
      Result := false;
      exit;
   end;
    if (endereco='') then begin
      MessageDlg('Nome não pode estar vazio',mtinformation,[mbOK],0);
      Result := false;
      exit;
   end;
    if (numero='') then begin
      MessageDlg('Nome não pode estar vazio',mtinformation,[mbOK],0);
      Result := false;
      exit;
   end;

    listaFuncionario:=TObjectList<TFuncionario>.Create;
    listaFuncionario.Add(TFuncionario.Create(nome,sobrenome,cpf,celular,cep,endereco,numero));
    dm.cadastrarFuncionario(ListaFuncionario);
    listaFuncionario.Free;
end;

end.
